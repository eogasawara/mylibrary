### Part 1

```{r}
1+2
```

```{r}
1:10
```

```{r}
a <- 1
```

```{r}
a
```

```{r}
a+2
```

```{r}
dado <- 1:6
```

```{r}
dado
```

```{r}
dado[1]
```

```{r}
dado[6]
```

```{r}
dado - 1
```

#### Package Installation

```{r}
available <- require(ggplot2)
if (!available) 
    install.packages("ggplot2")
```

#### Package loading

```{r}
library(ggplot2)
```

#### Variable definitions

```{r}
weight <- 60
height = 1.75
subject <- "A"
healthy <- TRUE
```

#### Variable evaluation

```{r}
weight
```

#### Variable type checking

```{r}
is.numeric(weight) # variable 
is.double(weight)
is.integer(weight)
is.character(subject)
```

#### Variable conversion

```{r}
weight <- as.integer(weight)
is.integer(weight)
```

#### Formulas

```{r}
#Body mass index (BMI)
bmi <- weight/height^2 
bmi 
```

#### String formatting

```{r}
message <- sprintf("%.1f", bmi)
print(message)
```

#### Vector definition

```{r}
weight <- c(60, 72, 57, 90, 95, 72) 
height <- c(1.75, 1.80, 1.65, 1.90, 1.74, 1.91)
subject <- c("A", "B", "C", "D", "E", "F")
```

#### Vector evaluation

```{r}
weight
height
subject
```

#### Creating a vector with a particular size

```{r}
vec <- rep(0, 10)
vec
```

#### Vector length

```{r}
length(weight)
```

#### Vector indexes

```{r}
weight[1]
weight[length(weight)]
```

#### for loop

```{r}
bmi <- 0
for (i in 1:length(weight)) {
  bmi[i] <- weight[i]/height[i]^2
}
```

```{r}
bmi
```

#### while loop

```{r}
i <- 1
while (i <= length(weight)) {
  bmi[i] <- weight[i]/height[i]^2
  i <- i + 1
}
```

```{r}
bmi
```

#### Removing variable

```{r}
rm(bmi)
exists("bmi")
```

#### Manipulating vectors efficiently

```{r}
bmi <- weight/height^2 
bmi 
```

#### Function definition

```{r}
compute_bmi <- function(weight, height) {
  bmi <- weight/height^2 
  return(bmi)
}
```

#### Using with scalar

```{r}
bmi <- compute_bmi(60, 1.75)
bmi
```

#### Using with vectors

```{r}
bmi <- compute_bmi(weight, height)
bmi
```

#### Average function

```{r}
average <- function(vec) {
    s <- 0
    n <- length(vec)
    for (x in vec) {
      s <- s + x  
    }
    return(s/n)
}
```

```{r}
avg_bmi <- average(bmi)
avg_bmi
```

#### Average function: improved version

```{r}
average <- function(vec) {
    s <- sum(vec)
    n <- length(vec)
    return(s/n)
}
```

```{r}
avg_bmi <- average(bmi)
avg_bmi
```

#### Average function: major statistical functions already exists

```{r}
average <- function(vec) {
    return(mean(vec))
}
```

```{r}
avg_bmi <- average(bmi)
avg_bmi
```

#### NA definition

```{r}
x <- c(10, NA, 13)
x
```

#### Evaluation with NA leads to NA

```{r}
average(x)
```

#### Addressing NA

```{r}
average <- function(vec) {
    return(mean(vec, na.rm=TRUE))
}
```

```{r}
average(x)
```

### Part #2

#### Setup variables

```{r}
weight <- c(60, 72, 57, 90, 95, 72) 
height <- c(1.75, 1.80, 1.65, 1.90, 1.74, 1.91)
subject <- c("A", "B", "C", "D", "E", "F")
```

#### Basic plot

```{r}
#options(repr.plot.width=5, repr.plot.height=5)
plot(height, weight)
```

#### Changing default values

```{r}
 plot(height, weight, pch=2)
```

#### Discovering default values

```{r}
args(plot.default)
```

```{r}
?plot
```

#### Adding a line

```{r}
plot(height, weight)
hh = c(1.65, 1.70, 1.75, 1.80, 1.85, 1.90)
lines(hh, 22.5 * hh^2)
```

#### Factors

```{r}
pain <- c(0,3,2,2,1)
fpain <- factor(pain,levels=0:3, ordered=TRUE)
fpain
```

#### Labeling categories

```{r}
levels(fpain) <- c("none","mild","medium","severe")
fpain
```

#### Convert double to factor

```{r}
lev <- rep("", length(height))

for (i in 1:length(height)) {
  if (height[i] < 1.7)
    lev[i] <- "short"
  else if (height[i] < 1.9)
    lev[i] <- "medium"
  else 
    lev[i] <- "tall"
}
lev <- as.factor(lev)
lev
```

#### Using cut function

```{r}
lev <- cut(height, breaks=c(0, 1.7, 1.9, .Machine$double.xmax), ordered=TRUE)
lev
levels(lev) <- c("short", "medium", "tall")
lev
```

#### Matrix

```{r}
x <- 1:9
x
```

#### Vector to matrix

```{r}
dim(x) <- c(3,3)
x
```

```{r}
x
```

```{r}
for (i in 1:nrow(x)) 
  for (j in 1:ncol(x))
    print(x[i,j])
```

```{r}
y <- x
for (i in 1:nrow(y)) 
  for (j in 1:ncol(y))
    y[i,j] <- 3 * y[i, j]

y
```

#### Multiplying matrix by 3

```{r}
y <- x
for (i in 1:nrow(y)) 
  for (j in 1:ncol(y))
    y[i,j] <- 3 * y[i, j]

y
```

```{r}
y <- 3*x
y
```

#### Vector to matrix by row

```{r}
x <- matrix(1:9,nrow=3,byrow=T)
x
```

#### Transpose matrix

```{r}
x <- t(x)
x
```

```{r}
a <- c(5260,5470,5640,6180,6390,6515,6805,7515,7515,8230,8770)
b <- c(3910,4220,3885,5160,5645,4680,5265,5975,6790,6900,7335)
```

#### Creating a list

```{r}
mybag <- list(a, b, 0, "a")
mybag
```

#### Adding an element in a list

```{r}
n <- length(mybag)
mybag[[n+1]] <- "b"
mybag
```

#### Slicing a list

```{r}
slice <- mybag[1]
slice
is.list(slice)
```

```{r}
slice <- mybag[c(1,3)]
slice
is.list(slice)
```

```{r}
#list is also a vector
is.vector(slice)
```

#### Extracting an element from a list

```{r}

h <- mybag[[1]]
h
```

```{r}
is.vector(h)
is.list(h)
```

#### Adding, accessing, and removing elements

```{r}
mybag <- list(x=a, y=b, const=0, lit="a")
mybag
```

```{r}
mybag$c <- mybag$x - mybag$y
mybag[[4]] <- NULL
mybag$const <- NULL
mybag
```

### Part #3

```{r}
a <- c(5260,5470,5640,6180,6390,6515,6805,7515,7515,8230,8770)
b <- c(3910,4220,3885,5160,5645,4680,5265,5975,6790,6900,7335)
```

```{r}
d <- data.frame(A=a, B=b)
head(d)
```

```{r}
d$C <- d$A + d$B
head(d)
```

```{r}
d$A <- NULL
head(d)
```

```{r}
wine = read.table(
  "http://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data", 
  header = TRUE, sep = ",")
head(wine)
```

#### Saving RData file

```{r}
# in Linux the default is not to compress
save(wine, file="wine.RData", compress=TRUE)
```

```{r}
rm(wine)
```

#### Load RData file

```{r}
load("wine.RData")
head(wine, 3)
```

#### Export data.frame into csv file

```{r}
write.table(wine, file="wine.csv", row.names=FALSE, quote = FALSE, sep = ",")
```

#### Filtering

```{r}
a <- c(5260,5470,5640,6180,6390,6515,6805,7515,7515,8230,8770)
b <- c(3910,4220,3885,5160,5645,4680,5265,5975,6790,6900,7335)
```

```{r}
# logical vector
i <- (a > 7000)
i
```

```{r}
a[i]
```

```{r}
b[a < 6000 | a > 7000]
```

```{r}
b[6000 <= a & a <= 7000]
```

#### Filtering data frames

```{r}
data <- data.frame(a=a, b=b)
data$c <- data$a - data$b
head(data, nrow(data))
```

```{r}
head(data[data$a > 7000,])
```

```{r}
head(data[data$a > 7000,c(1,2)])
```

#### Benchmarking matrix and data.frames

```{r}
rheight <- rnorm(100000, 1.8, sd=0.2)
rweight <- rnorm(100000, 72, sd=15)
```

#### Computing an entire column at once

```{r}
start_time <- Sys.time()
hw <- data.frame(height=rheight, weight=rweight)
hw$bmi <- hw$weight/hw$height^2
end_time <- Sys.time()
end_time - start_time
object.size(hw)
```

#### Processing element by element

```{r}
start_time <- Sys.time()
hw <- data.frame(height=rheight, weight=rweight)
for (i in 1:nrow(hw)) {
  hw$bmi[i] <- hw$weight[i]/hw$height[i]^2
}
end_time <- Sys.time()
end_time - start_time
```

#### Convert the entire data.frame

```{r}
start_time <- Sys.time()
hw <- data.frame(height=rheight, weight=rweight)
hw <- as.matrix(hw)
hw <- cbind(hw, 0)
for (i in 1:nrow(hw)) {
  hw[i,3] <- hw[i,2]/hw[i,1]^2
}
end_time <- Sys.time()
end_time - start_time
```

#### apply family

```{r}
library(ISwR)
data(thuesen)
head(thuesen)
```

```{r}
lapply(thuesen, mean, na.rm=T)
```

```{r}
sapply(thuesen, mean, na.rm=T)
```

```{r}
m <- as.matrix(thuesen)
apply(m, 1, min, na.rm=TRUE)
apply(m, 2, min, na.rm=TRUE)
```

```{r}
library(ISwR)
data(thuesen)
head(thuesen)
```

```{r}
sort(thuesen$blood.glucose)
```

```{r}
order(thuesen$blood.glucose)
```

```{r}
o <- order(thuesen$blood.glucose)
sorted <- thuesen[o,]
head(sorted)
```

### Part #4

```{r}
weight <- c(60, 72, 57, 90, 95, 72) 
height <- c(1.75, 1.80, 1.65, 1.90, 1.74, 1.91)
subject <- c("A", "B", "C", "D", "E", "F")
d <- data.frame(weight=weight, height=height, subject=subject)
head(d)   

```

```{r}
subject <- c("A", "B", "C", "D", "E", "F")
state <- c("RJ", "SP", "MG", "RJ", "SP", "MG")
ds <- data.frame(subject=subject, state=state)
head(d)
```

```{r}
dsm <- merge(d, ds, by.x="subject", by.y="subject")
head(dsm)    
```

```{r}
lib <- require(dplyr)
if (!lib)
    install.packages("dplyr")
library(dplyr)
```

```{r}
result <- dsm |> 
    filter(height>1.7) |> 
    select(subject, weight, height) |> 
    arrange(height)
head(result)    
```

```{r}
result <- dsm |> 
    group_by(state) |>
    summarize(count = n(), height = mean(height))
head(result)    
```

